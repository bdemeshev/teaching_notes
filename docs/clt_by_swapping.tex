% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\usepackage{mathtools}
\newcommand{\cN}{\mathcal{N}}

\let\P\relax
\DeclareMathOperator{\P}{\mathbb{P}}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\plim}{plim}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}

\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
% TODO: automatic scaling does not work in pdf???

% TODO: no cyrillic font in section titles!
\setmainfont{Linux Libertine}

%\newfontfamily{\cyrillicfont}{Linux Libertine}
%\newfontfamily{\cyrillicfonttt}{Linux Libertine}
%\newfontfamily{\cyrillicfontsf}{Linux Libertine}
%\newfontfamily{\cyrillicfontrm}{Linux Libertine}
%\newfontfamily{\cyrillicfontbf}{Linux Libertine}
%\newfontfamily{\cyrillicfontmd}{Linux Libertine}
%\newfontfamily{\cyrillicfontit}{Linux Libertine}
%\newfontfamily{\cyrillicfontsl}{Linux Libertine}
%\newfontfamily{\cyrillicfontsc}{Linux Libertine}
%\newfontfamily{\cyrillicfontup}{Linux Libertine}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Содержание}
\else
  \newcommand\contentsname{Содержание}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{Список Иллюстраций}
\else
  \newcommand\listfigurename{Список Иллюстраций}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{Список Таблиц}
\else
  \newcommand\listtablename{Список Таблиц}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Рисунок}
\else
  \newcommand\figurename{Рисунок}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Таблица}
\else
  \newcommand\tablename{Таблица}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Список}
\newcommand*\listoflistings{\listof{codelisting}{Список Каталогов}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\ifLuaTeX
\usepackage[bidi=basic]{babel}
\else
\usepackage[bidi=default]{babel}
\fi
\babelprovide[main,import]{russian}
% get rid of language-specific shorthands (see #6817):
\let\LanguageShortHands\languageshorthands
\def\languageshorthands#1{}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Доказательство ЦПТ последовательной подменой слагаемых},
  pdflang={ru},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Доказательство ЦПТ последовательной подменой слагаемых}
\author{}
\date{}

\begin{document}
\maketitle

\renewcommand*\contentsname{Содержание}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
Центральная предельная теорема (ЦПТ) обещает нам, что сумма независимых
одинаково распределенных слагаемых примерно нормально распределена. Эти
заметки посвещены доказательству ЦПТ без использования
характеристических функций.

\section{Воспоминания}\label{sec-recall}

Для аккуратной формулировки и доказательства вспомним сначала
определение сходимости по распределению.

\begin{tcolorbox}[enhanced jigsaw, coltitle=black, titlerule=0mm, opacityback=0, colframe=quarto-callout-note-color-frame, bottomrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, leftrule=.75mm, left=2mm, arc=.35mm, rightrule=.15mm, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Сходимость по распределению}, bottomtitle=1mm, toprule=.15mm, breakable, opacitybacktitle=0.6, colback=white]

Последовательность случайных величин \((R_n)\) сходится к \(R\) по
распределению, если \[
\lim_{n\to\infty} \mathop{\mathrm{\mathbb{P}}}(R_n \leq x) = \mathop{\mathrm{\mathbb{P}}}(R\leq x) = F(x)
\] в любой точке \(x\), где функция распределения \(F\) величины \(R\)
непрерывна.

\end{tcolorbox}

Перед доказательством ЦПТ нам потребуется лемма. Эта лемма позволяет от
пределов вероятностей перейти к изучению пределов ожиданий гладких
функций. Казалось бы, вероятности проще, чем ожидания, да ещё каких-то
ненаписанных явно гладких функций! Однако для гладких функций применима
мощнейшая идея разложения в ряд Тейлора.

\begin{tcolorbox}[enhanced jigsaw, coltitle=black, titlerule=0mm, opacityback=0, colframe=quarto-callout-note-color-frame, bottomrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, leftrule=.75mm, left=2mm, arc=.35mm, rightrule=.15mm, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Лемма}, bottomtitle=1mm, toprule=.15mm, breakable, opacitybacktitle=0.6, colback=white]

Для того, чтобы последовательность случайных величин \((R_n)\) сходилась
к \(R\) по распределению достаточно того, что для любой бесконечно
дифференцируемой функций \(h\) с ограниченными производными выполнено
условие \[
\lim_{n\to\infty} \mathop{\mathrm{\mathbb{E}}}(h(R_n)) = \mathop{\mathrm{\mathbb{E}}}(h(R)).
\]

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, coltitle=black, titlerule=0mm, opacityback=0, colframe=quarto-callout-caution-color-frame, bottomrule=.15mm, colbacktitle=quarto-callout-caution-color!10!white, leftrule=.75mm, left=2mm, arc=.35mm, rightrule=.15mm, toptitle=1mm, title=\textcolor{quarto-callout-caution-color}{\faFire}\hspace{0.5em}{Доказательство леммы}, bottomtitle=1mm, toprule=.15mm, breakable, opacitybacktitle=0.6, colback=white]

Нам надо доказать, что при большом \(n\) вероятность
\(\mathop{\mathrm{\mathbb{P}}}(R_n\leq x)\) не может слишком сильно
отличаться от вероятности \(\mathop{\mathrm{\mathbb{P}}}(R \leq x)\) ни
в большую, ни в меньшую сторону.

Докажем половину утверждения, вторая половина доказывается по аналогии.
Основная идея доказательства такова: вероятность
\(\mathop{\mathrm{\mathbb{P}}}(R_n \leq x)\) можно заменить на ожидание
\(\mathop{\mathrm{\mathbb{E}}}(I(R_n \leq x))\), а «ступенчатый»
индикатор \(I\) можно сколь угодно точно приблизить гладкой много раз
дифференцируемой функцией.

Поехали. Выбираем произвольное положительное \(\varepsilon\). Наша цель
--- доказать, что начиная с некоторого \(n\) вероятность
\(\mathop{\mathrm{\mathbb{P}}}(R_n \leq x) > \mathop{\mathrm{\mathbb{P}}}(R \leq x) - \varepsilon\).

С помощью ожидания индикатора и функции распределения \(F\) величины
\(R\) наша цель записывается так: \[
\mathop{\mathrm{\mathbb{E}}}(I(R_n \leq x)) > F(x) - \varepsilon.
\]

Отступим от точки \(x\) чуть-чуть влево, в точку \(x - \delta\). В силу
непрерывности \(F\) в точке \(x\) размер оступа \(\delta\) можно выбрать
так, что \(F(x-\delta) > F(x) - \varepsilon/2\).

Теперь придумаем гладкую функцию \(h\), которая чуть-чуть занижает
индикатор \(I(R_n \leq x)\). А именно, левее \(x-\delta\) функция \(h\)
равна 1, правее \(x\) функция \(h\) равна нулю, а на отрезке
\([x-\delta, x]\) функция \(h\) плавно спускается от 1 к 0. По
построению, \[
I(R_n \leq x - \delta) \leq h(R_n) \leq I(R_n \leq x).
\] Делаем первый шаг по замене индикатора на не превосходящую его
гладкую функцию \(h\): \[
\mathop{\mathrm{\mathbb{P}}}(R_n\leq x) = \mathop{\mathrm{\mathbb{E}}}(I(R_n \leq x)) \geq \mathop{\mathrm{\mathbb{E}}}(h(R_n)).
\] Теперь выберем \(n\) достаточно большим, так, чтобы \[
\mathop{\mathrm{\mathbb{E}}}(h(R_n)) \geq \mathop{\mathrm{\mathbb{E}}}(h(R)) - \varepsilon/2. 
\] Теперь заменяем гладкую функцию \(h\) на не превосходящий её
индикатор, \[
\mathop{\mathrm{\mathbb{E}}}(h(R)) - \varepsilon/2 \geq \mathop{\mathrm{\mathbb{E}}}(I(R \leq x-\delta)) - \varepsilon/2 = F(x-\delta) - \varepsilon/2.
\] Вспоминаем, что точку \(x-\delta\) мы выбрали недалеко от \(x\) и
получаем в итоге, что начиная с некоторого \(n\) \[
\mathop{\mathrm{\mathbb{P}}}(X_n \leq x) \geq F(x) - \varepsilon.
\] Аналогично доказывается и вторая половина. На этот раз надо отступать
от \(x\) вправо в точку \(x+\delta\), и заменять индикатор
\(I(R_n \leq x)\) мажорирующей его гладкой функцией \(h\).

\end{tcolorbox}

По доказательству видно, что лемма остается верна, если расширить класс
функций до просто непрерывных или до трижды дифференцируемых с конечными
производными.

При желании можно сконструировать используемую в доказательстве функцию
\(h\) явно, например, на базе бесконечно плавно стартующей из нуля
функции \[
g(t) = \begin{cases}
\exp(1/t) \text{ при } t>0, \\
0, \text{ при } t\leq 0.
\end{cases}
\]

\begin{tcolorbox}[enhanced jigsaw, coltitle=black, titlerule=0mm, opacityback=0, colframe=quarto-callout-caution-color-frame, bottomrule=.15mm, colbacktitle=quarto-callout-caution-color!10!white, leftrule=.75mm, left=2mm, arc=.35mm, rightrule=.15mm, toptitle=1mm, title=\textcolor{quarto-callout-caution-color}{\faFire}\hspace{0.5em}{Упражнение к лемме}, bottomtitle=1mm, toprule=.15mm, breakable, opacitybacktitle=0.6, colback=white]

Докажите, что для любого \(\varepsilon\) начиная с некоторого \(n\)
выполнено неравенство

\[
\mathop{\mathrm{\mathbb{P}}}(X_n \leq x) \leq F(x) + \varepsilon.
\]

\end{tcolorbox}

\section{Формулировка цпт}\label{sec-clt-statement}

Вспомним одну из формулировок ЦПТ.

\begin{tcolorbox}[enhanced jigsaw, coltitle=black, titlerule=0mm, opacityback=0, colframe=quarto-callout-note-color-frame, bottomrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, leftrule=.75mm, left=2mm, arc=.35mm, rightrule=.15mm, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Центральная предельная теорема}, bottomtitle=1mm, toprule=.15mm, breakable, opacitybacktitle=0.6, colback=white]

Если величины \(Q_1\), \(Q_2\), \ldots, независимы и одинаково
распределены с конечным ожиданием \(\mu\) и дисперсией \(\sigma^2\), то
отмасштабированная сумма \[
Z_n = \frac{\sum_{i=1}^n Q_i - \mathop{\mathrm{\mathbb{E}}}(\sum_{i=1}^n Q_i)}{\sqrt{\mathop{\mathrm{Var}}(\sum_{i=1}^n Q_i)}}
\] стремится по распределению к \(\mathcal{N}(0;1)\).

\end{tcolorbox}

\section{Доказательство}\label{sec-clt-proof}

Для начала представим \(S_n\) в виде отмасштабированных слагаемых. \[
Z_n = \frac{Q_1 - \mu}{\sigma \sqrt n} + \ldots + \frac{Q_{n-1} - \mu}{\sigma \sqrt n} + \frac{Q_n - \mu}{\sigma \sqrt n} = X_1 + \ldots + X_{n-1} + X_n
\] Замечаем, что \(\mathop{\mathrm{\mathbb{E}}}(X_i) = 0\),
\(\mathop{\mathrm{Var}}(X_i) = 1/n\).

\subsection{Идея постепенной подмены слагаемых}\label{sec-swapping-idea}

Теперь потихоньку начнем менять слагаемые в правом хвосте на независимые
слагаемые \(Y_i\) с таким же нулевым ожиданием, такой же дисперсией
\(1/n\), но нормально распределенные:

Удалим \(X_n\), добавим \(Y_n\), удалим \(X_{n-1}\), добавим
\(Y_{n-1}\), и так далее\ldots{}

Промежуточную сумму до удаления очередного \(X_i\) обозначим с помощью
\(Z_{n,i}\), а после удаления очередного \(X_i\) --- с помощью
\(S_{n,i}\).

Для трёх величин схема выглядит так: \[
X_1 + X_2 + X_3 = Z_{3,3} \overset{-X_3}{\longrightarrow}S_{3,3}\overset{+Y_3}{\longrightarrow}Z_{3,2}\overset{-X_2}{\longrightarrow}S_{3,2}\overset{+Y_2}{\longrightarrow}Z_{3,1}\overset{-X_1}{\longrightarrow}S_{3,1}\overset{+Y_1}{\longrightarrow}Z_{3,0}=Y_1 + Y_2 + Y_3
\]

Величина \(Z_{n,i}\) будет своими первыми \(i\) слагаемыми содержать
иксы, а оставшимися слагаемыми --- игреки. В сумме \(S_{n,i}\) полностью
отсутствует \(i\)-е слагаемое, слагаемые с меньшими номерами --- это
\(X_1\), \ldots, \(X_{i-1}\), слагаемые с большими номерами --- это
\(Y_{i+1}\), \ldots, \(Y_n\).

Для наглядного примера, \[
Z_{5, 3} = X_1 + X_2 + X_3 + Y_4 + Y_5,
\] \[
S_{5, 3} = X_1 + X_2 + 0 + Y_4 + Y_5,
\]

В общем виде схема выглядит так: \[
\sum_{i=1}^n X_i = Z_{n,n} \overset{-X_n}{\longrightarrow}S_{n,n}\overset{+Y_n}{\longrightarrow}Z_{n,n-1}\overset{-X_{n-1}}{\longrightarrow} \ldots \overset{-X_2}{\longrightarrow}S_{n,2}\overset{+Y_2}{\longrightarrow}Z_{n,1}\overset{-X_1}{\longrightarrow}S_{n,1}\overset{+Y_1}{\longrightarrow}Z_{n,0}=\sum_{i=1}^n Y_i
\] В схеме \(n\) шагов, каждый из которых состоит из двух полушагов,
удаления \(X_i\) и добавления \(Y_i\).

Заметим, что \(S_{n,i}\) не зависит ни от \(X_i\), ни от \(Y_i\). Это
пригодится.

Замечаем также, что
\(Z_{n,0} = Y_1 + \ldots + Y_n \sim \mathcal{N}(0;1)\).

В силу леммы нам достаточно доказать, что для любой бесконечно
дифференцируемой \(h\) с ограниченными производными
\(\mathop{\mathrm{\mathbb{E}}}(h(Z_{n,n})) \to \mathop{\mathrm{\mathbb{E}}}(h(Z_{n,0}))\).

\subsection{Выбираем произвольное
эпсилон}\label{ux432ux44bux431ux438ux440ux430ux435ux43c-ux43fux440ux43eux438ux437ux432ux43eux43bux44cux43dux43eux435-ux44dux43fux441ux438ux43bux43eux43d}

Поехали. Выбираем произвольное положительное \(\varepsilon\). Наша цель
--- доказать, что начиная с некоторого \(n\) отличие этих двух ожиданий
невелико, \[
\mathop{\mathrm{\mathbb{E}}}(h(Z_{n,n})) - \mathop{\mathrm{\mathbb{E}}}(h(Z_{n,0})) \in [-\varepsilon;+\varepsilon].
\]

Посмотрим на нашу схему подмен \[
h\left(\sum_{i=1}^n X_i\right)=h(Z_{n,n}) \overset{-X_n}{\longrightarrow}h(S_{n,n})\overset{+Y_n}{\longrightarrow}h(Z_{n,n-1})\overset{-X_{n-1}}{\longrightarrow} \ldots \overset{+Y_2}{\longrightarrow}h(Z_{n,1})\overset{-X_1}{\longrightarrow}h(S_{n,1})\overset{+Y_1}{\longrightarrow}h(Z_{n,0})=h\left(\sum_{i=1}^n Y_i\right)
\]

С ростом \(n\) цепочка растет, а каждый шаг по идее должен становится
всё меньше. Если мы докажем, что начиная с некоторого \(n\) разница \[
\mathop{\mathrm{\mathbb{E}}}(h(Z_{n,i})) - \mathop{\mathrm{\mathbb{E}}}(h(Z_{n,i-1}))
\] от \textbf{каждого} шага становится по модулю меньше
\(\varepsilon/n\), то дело будет в шляпе!

\subsection{Анализ первой пары
полушагов}\label{ux430ux43dux430ux43bux438ux437-ux43fux435ux440ux432ux43eux439-ux43fux430ux440ux44b-ux43fux43eux43bux443ux448ux430ux433ux43eux432}

Остановимся на первой паре полушагов, \[
h(Z_{n,n}) \overset{-X_n}{\longrightarrow}h(S_{n,n})\overset{+Y_n}{\longrightarrow}h(Z_{n,n-1})
\] Доказательство для других пар полушагов полностью аналогично.

Наша разница \(h(Z_{n,n}) - h(Z_{n,n-1})\) разбивается в два полушага,
\[
\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(Z_{n,n-1}) = \left(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \right) - \left(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n-1}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \right).
\]

Заглянем в будущее, чтобы осознать план действий. Оказывается, что обе
полушаговых разницы,
\(\left(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \right)\)
и
\(\left(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n-1}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \right)\),
очень похожи на некоторую общую величину. Эта величина окажется равной
\(\mathop{\mathrm{\mathbb{E}}}\left(\frac{h''(S_{n,n})}{2n}\right)\), но
это не важно. Важно, что начиная с некоторого \(n\) отличие каждой
полушаговой разницы от этой общей величины будет меньше
\(\varepsilon/2n\). При вычитании двух разниц общая величина
уничтожится, и разница для целого шага окажется по модулю меньше
\(\varepsilon/n\).

Проведем доказательство для разницы первого полушага,
\(\left(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \right)\).
Доказательство для разницы второго полушага,
\(\left(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n-1}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \right)\),
аналогично.

В этот момент можно уже не писать индекс \((n,n)\) у \(Z\) и \(S\) :)

\subsection{Линеаризация разницы для
полушага}\label{ux43bux438ux43dux435ux430ux440ux438ux437ux430ux446ux438ux44f-ux440ux430ux437ux43dux438ux446ux44b-ux434ux43bux44f-ux43fux43eux43bux443ux448ux430ux433ux430}

Выполним линеаризацию функции \(h(Z_{n,n})\) в окрестности точки
\(S_{n,n}\). Заметим предварительно, что эти точки отличаются ровно на
\(X_n\), \(Z_{n,n} = S_{n,n} + X_n\). \[
h(Z_{n,n}) \approx h(S_{n,n}) + h'(S_{n,n})(Z_{n,n} - S_{n,n}) = h(S_{n,n}) + h'(S_{n,n}) X_n.
\] Для доказательства потребуется вспомнить точный смысл примерного
равенства, а именно, остаток в форме Лагранжа. Найдётся такая точка
\(C\) между \(S_{n,n}\) и \(Z_{n,n}\), что \[
h(Z_{n,n}) = h(S_{n,n}) + h'(S_{n,n})X_n + \frac{h''(C)}{2!}X_n^2.
\] Выделяем нужную нам разницу, \[
h(Z_{n,n}) - h(S_{n,n}) = h'(S_{n,n})X_n + \frac{h''(C)}{2!}X_n^2.
\] Прибавим и вычтем справа в числителе \(h''(S_{n,n})\), \[
h(Z_{n,n}) - h(S_{n,n}) = h'(S_{n,n})X_n + \frac{h''(S_{n,n})}{2!}X_n^2 + \frac{h''(C) - h''(S_{n,n})}{2!}X_n^2.
\]

Берём математическое ожидание, вспомнив, что
\(\mathop{\mathrm{\mathbb{E}}}(X_n) =0\),
\(\mathop{\mathrm{Var}}(X_n)= 1/n\), а \(X_n\) не зависит от \(S_n\), \[
\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) = 0 + \mathop{\mathrm{\mathbb{E}}}\left(\frac{h''(S_{n,n})}{2n}\right) + \mathop{\mathrm{\mathbb{E}}}\left(\frac{h''(C) - h''(S_{n,n})}{2}X_n^2\right).
\]

\subsection{Два случая для сложного
слагаемого}\label{ux434ux432ux430-ux441ux43bux443ux447ux430ux44f-ux434ux43bux44f-ux441ux43bux43eux436ux43dux43eux433ux43e-ux441ux43bux430ux433ux430ux435ux43cux43eux433ux43e}

Сосредоточимся на последнем слагаемом и рассмотрим два случая, в
зависимости от того, больше ли \(\left\lvert X_n \right\rvert\) чем
\(\delta\). \[
\frac{h''(C) - h''(S_{n,n})}{2!}X_n^2 = \left(\frac{h''(C) - h''(S_{n,n})}{2!}X_n^2I(\left\lvert X_n \right\rvert \leq \delta)\right) + \left(\frac{h''(C) - h''(S_{n,n})}{2!}X_n^2I(\left\lvert X_n \right\rvert > \delta)\right).
\] Изучаем первое слагаемое. Вспомним, что точка \(C\) находится между
\(S_{n,n}\) и \(Z_{n,n}\), а \(S_{n,n} + X_n = Z_{n,n}\). Поэтому
\(\left\lvert C - S_{n,n} \right\rvert \leq \delta\), если
\(\left\lvert X_n \right\rvert\leq \delta\).

У функции \(h\) ограничена третья производная, выберем \(\delta\)
настолько маленьким, чтобы зажать разницу \(h''(C) - h''(S_{n,n})\) до
величины меньшей \(\varepsilon/2\).

Получаем ограничение для первого слагаемого, \[
\mathop{\mathrm{\mathbb{E}}}\left\lvert \frac{h''(C) - h''(S_{n,n})}{2!}X_n^2I(\left\lvert X_n \right\rvert \leq \delta) \right\rvert \leq E\left(\frac{\varepsilon}{4}X_n^2\right)=\frac{\varepsilon}{4n}
\] Изучаем второе слагаемое. У функции \(h\) ограничена вторая
производная константой \(M\).

\[
\mathop{\mathrm{\mathbb{E}}}\left\lvert \frac{h''(C) - h''(S_{n,n})}{2!}X_n^2I(\left\lvert X_n \right\rvert > \delta) \right\rvert \leq E\left(\frac{M + M}{4}X_n^2I(\left\lvert X_n \right\rvert > \delta)\right)=\frac{M}{2n}\mathop{\mathrm{\mathbb{E}}}(X_n^2I(\left\lvert X_n \right\rvert > \delta))
\]

Подберем \(n\) настолько большим, что
\(\mathop{\mathrm{\mathbb{E}}}(X_n^2 I(\left\lvert X_n \right\rvert > \delta)) < \varepsilon/2M\).
При этом второе слагаемое будет также ограничено величиной
\(\varepsilon/4n\). Тем самым мы доказали, что начиная с некоторого
\(n\) \[
\mathop{\mathrm{\mathbb{E}}}\left\lvert \frac{h''(C) - h''(S_{n,n})}{2!}X_n^2  \right\rvert \leq \frac{\varepsilon}{4n} + \frac{\varepsilon}{4n} = \frac{\varepsilon}{2n}
\] То есть, \[
\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \in \left[ \mathop{\mathrm{\mathbb{E}}}\left(\frac{h''(S_{n,n})}{2n}\right) - \frac{\varepsilon}{2n}; \mathop{\mathrm{\mathbb{E}}}\left(\frac{h''(S_{n,n})}{2n}\right) + \frac{\varepsilon}{2n} \right].
\] В этот же диапазон попадает и величина
\(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n-1}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n})\),
поэтому \[
\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(Z_{n,n-1}) \in \left[ - \frac{\varepsilon}{n}; + \frac{\varepsilon}{n} \right].
\]

\subsection{Взгляд
назад}\label{ux432ux437ux433ux43bux44fux434-ux43dux430ux437ux430ux434}

Вспомним наш долгий путь. Сначала мы разбили разницу
\(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(Z_{n,0})\)
на \(2n\) полушагов. Каждый шаг состоит из полушага удаления \(X_i\) и
полушага добавления \(Y_i\). Изменение
\(\mathop{\mathrm{\mathbb{E}}}h\), вызванное каждым шагом, состоит из
разницы изменений вызванных полушагами. А изменение от каждого полушага
при больших \(n\) не отличается от общей константы более чем на
\(\varepsilon/2n\). Поэтому каждый шаг даёт изменение не больше
\(\varepsilon/n\), и вся разница
\(\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n}) - \mathop{\mathrm{\mathbb{E}}}h(Z_{n,0})\)
начиная с некоторого момента меньше \(\varepsilon\).

\begin{tcolorbox}[enhanced jigsaw, coltitle=black, titlerule=0mm, opacityback=0, colframe=quarto-callout-caution-color-frame, bottomrule=.15mm, colbacktitle=quarto-callout-caution-color!10!white, leftrule=.75mm, left=2mm, arc=.35mm, rightrule=.15mm, toptitle=1mm, title=\textcolor{quarto-callout-caution-color}{\faFire}\hspace{0.5em}{Упражнение к теореме}, bottomtitle=1mm, toprule=.15mm, breakable, opacitybacktitle=0.6, colback=white]

Докажите, что для любого \(\varepsilon\) начиная с некоторого \(n\)
выполнено условие

\[
\mathop{\mathrm{\mathbb{E}}}h(Z_{n,n-1}) - \mathop{\mathrm{\mathbb{E}}}h(S_{n,n}) \in \left[ \mathop{\mathrm{\mathbb{E}}}\left(\frac{h''(S_{n,n})}{2!}\right) - \frac{\varepsilon}{2n}; \mathop{\mathrm{\mathbb{E}}}\left(\frac{h''(S_{n,n})}{2!}\right) + \frac{\varepsilon}{2n} \right].
\]

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, coltitle=black, titlerule=0mm, opacityback=0, colframe=quarto-callout-caution-color-frame, bottomrule=.15mm, colbacktitle=quarto-callout-caution-color!10!white, leftrule=.75mm, left=2mm, arc=.35mm, rightrule=.15mm, toptitle=1mm, title=\textcolor{quarto-callout-caution-color}{\faFire}\hspace{0.5em}{Решение упражнения к теореме}, bottomtitle=1mm, toprule=.15mm, breakable, opacitybacktitle=0.6, colback=white]

Линеаризовать также надо в окрестности точки \(S_{n,n}\), а разница
\(Z_{n,n-1}-S_{n,n}\) окажется равной \(Y_n\). По ожиданию и дисперсии
\(Y_n\) ничем не отличается от \(X_n\). Поэтому остаётся лишь полностью
скопировать доказательство с заменой \(X_n\) на \(Y_n\).

\end{tcolorbox}

\subsection{Источники}\label{ux438ux441ux442ux43eux447ux43dux438ux43aux438}

В основном изложение следует статье (Chin 2022). Постарался сделать
изложение более «мотивированным», чтобы перед шагами яснее была видна
цель. Также излагаю один случай из повторяющихся. С одной стороны, это
облегчает понимание, с другой стороны аналогичный случай можно решать в
виде упражнения.

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-Chin2022ASA}
Chin, Calvin Wooyoung. 2022. {«A Short and Elementary Proof of the
Central Limit Theorem by Individual Swapping»}. \emph{The American
Mathematical Monthly} 129: 374--80.
\url{https://arxiv.org/abs/2106.00871}.

\end{CSLReferences}



\end{document}
